<!DOCTYPE html>
<html lang="en">
<head>
  <title>Search Results - OPTICFRAMES</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <style>
    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }
    .navbar-inverse {
    background-color: #E5E5E5 !important;
    border-color: #E5E5E5;
    }
    .navbar-inverse .navbar-nav > li > a {
        color: #000;
    }

    /* Search Header */
    .search-header {
        background-color: #f8f9fa;
        padding: 40px 0;
        margin-bottom: 30px;
        text-align: center;
    }
    
    .search-title {
        font-size: 2.5em;
        font-weight: 300;
        margin-bottom: 10px;
        color: #333;
    }
    
    .search-subtitle {
        font-size: 1.2em;
        color: #666;
    }

    /* Filters Panel */
    .filters-panel {
        background: #f8f9fa;
        border: 1px solid #e0e0e0;
        padding: 20px;
        margin-bottom: 30px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    .filter-section {
        margin-bottom: 20px;
    }
    
    .filter-title {
        font-weight: 600;
        color: #333;
        margin-bottom: 10px;
        font-size: 1.1em;
    }

    /* Results Info */
    .results-info {
        background: white;
        padding: 15px;
        border: 1px solid #e0e0e0;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        margin-bottom: 20px;
    }
    
    .sort-section {
        text-align: right;
    }

    /* Product Cards - Matching Main Template Style */
    .product-card {
    border: 1px solid #e0e0e0;
    margin-bottom: 30px;
    padding: 15px;
    position: relative;
    height: 100%;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    transition: all 0.3s ease;
    }

    .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .product-img-container {
    overflow: hidden;
    margin-bottom: 15px;
    position: relative;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 160px;
    }

    @media (max-width: 767.98px) {
    .product-img-container {
        height: 120px;
    }
    }

    @media (min-width: 768px) and (max-width: 991.98px) {
    .product-img-container {
        height: 140px;
    }
    }

    .bestseller-badge {
    position: absolute;
    top: 0;
    left: 0;
    background-color: #f0f0f0;
    color: #333;
    font-size: 12px;
    font-weight: bold;
    padding: 2px 8px;
    z-index: 2;
    }

    .new-badge {
    position: absolute;
    top: 0;
    left: 0;
    background-color: #f0f0f0;
    color: #333;
    font-size: 12px;
    font-weight: bold;
    padding: 2px 8px;
    z-index: 2;
    }

    .discount-badge {
    position: absolute;
    top: 0;
    right: 0;
    background-color: #dc3545;
    color: white;
    font-size: 12px;
    font-weight: bold;
    padding: 2px 8px;
    z-index: 2;
    }

    .product-info {
    margin-top: 10px;
    }

    .product-name {
    font-weight: bold;
    margin-bottom: 0;
    }

    .product-category {
    color: #666;
    font-size: 14px;
    }

    .product-colors {
    color: #666;
    font-size: 14px;
    margin-bottom: 5px;
    }

    .product-rating {
    color: #f8ce0b;
    margin-bottom: 5px;
    }

    .product-price {
    font-weight: bold;
    font-size: 18px;
    }

    .original-price {
    text-decoration: line-through;
    color: #999;
    font-size: 16px;
    margin-right: 5px;
    }

    .lens-discount {
    color: #0275d8;
    font-weight: bold;
    float: right;
    }

    /* No Results */
    .no-results {
        text-align: center;
        padding: 60px 20px;
        color: #666;
    }
    
    .no-results i {
        font-size: 4em;
        margin-bottom: 20px;
        color: #ddd;
    }

    /* Pagination */
    .pagination-wrapper {
        margin-top: 40px;
        text-align: center;
    }

    /* Footer Styles */
    .footer {
    background-color: rgb(83, 83, 83);
    color: #fff;
    padding: 40px 20px;
    font-size: 14px;
    }
    .footer a {
    color: #ccc;
    text-decoration: none;
    }
    .footer a:hover {
    color: #ffffff;
    }
    .footer h3 {
    color: #fff;
    margin-bottom: 20px;
    }
    .footer hr {
    border-top: 1px solid #ccc;
    }
    .app-links img {
    height: 40px;
    margin-right: 10px;
    }
    .social-icons a {
    color: #fff;
    font-size: 18px;
    margin-left: 10px;
    }
    .social-icons a:hover {
    color: #0d6efd;
    }

    /* Mobile Responsive Styles */
    @media (max-width: 768px) {
        .search-header {
            padding: 20px 0;
            margin-bottom: 20px;
        }
        
        .search-title {
            font-size: 1.8em;
            margin-bottom: 5px;
        }
        
        .search-subtitle {
            font-size: 1em;
        }
        
        .filters-panel {
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .filter-section {
            margin-bottom: 15px;
        }
        
        .filter-title {
            font-size: 1em;
            margin-bottom: 5px;
        }
        
        .results-info {
            padding: 10px;
        }
        
        .sort-section {
            text-align: left;
            margin-top: 15px;
        }
        
        .product-card {
            margin-bottom: 20px;
        }
        
        .pagination {
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .pagination li {
            margin: 2px;
        }
    }
    
    @media (max-width: 480px) {
        .container {
            padding-left: 10px;
            padding-right: 10px;
        }
        
        .search-title {
            font-size: 1.5em;
        }
        
        .filters-panel {
            padding: 10px;
        }
        
        .form-control {
            font-size: 16px; /* Prevents zoom on iOS */
        }
    }
  </style>
</head>
<body>

  <!-- Navigation Bar -->
  <nav class="navbar navbar-inverse" style="background-color: grey;">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="{% url 'index' %}" style="color: black;">ＯＰＴＩＣＦＲＡＭＥＳ</a>
      </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="{% url 'Profile' %}">Profile</a></li>
          <li><a href="{% url 'about' %}">About</a></li>  
          <li><a href="{% url 'view_cart' %}">Cart</a></li>
          {% if user.is_authenticated %}
          <li><a href="{% url 'signout' %}"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
          {% else %}
          <li><a href="{% url 'userin' %}"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
          {% endif %}        
        </ul>
      </div>
    </div>
  </nav>

  <!-- Search Header -->
  <div class="search-header">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h1 class="search-title">
            <i class="fas fa-search"></i>
            Search Results
          </h1>
          {% if query %}
            <p class="search-subtitle">Results for "{{ query }}"</p>
          {% else %}
            <p class="search-subtitle">All Products</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Filters Panel -->
    <div class="row">
      <div class="col-md-12">
        <div class="filters-panel">
          <form method="GET" action="{% url 'search_products' %}">
            <input type="hidden" name="q" value="{{ query }}">
            
            <div class="row">
              <!-- Search Input -->
              <div class="col-md-3 col-sm-6 col-xs-12">
                <div class="filter-section">
                  <label class="filter-title">Search</label>
                  <input type="text" class="form-control" name="q" value="{{ query }}" placeholder="Search eyewear...">
                </div>
              </div>
              
              <!-- Category Filter -->
              <div class="col-md-2 col-sm-6 col-xs-12">
                <div class="filter-section">
                  <label class="filter-title">Category</label>
                  <select name="category" class="form-control">
                    <option value="">All Categories</option>
                    {% for cat in categories %}
                      <option value="{{ cat.id }}" {% if cat.id|stringformat:"s" == selected_category %}selected{% endif %}>
                        {{ cat.name }}
                      </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              
              <!-- Gender Filter -->
              <div class="col-md-2 col-sm-6 col-xs-12">
                <div class="filter-section">
                  <label class="filter-title">Gender</label>
                  <select name="gender" class="form-control">
                    <option value="">All Genders</option>
                    {% for gender in genders %}
                      <option value="{{ gender.id }}" {% if gender.id|stringformat:"s" == selected_gender %}selected{% endif %}>
                        {{ gender.name }}
                      </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              
              <!-- Material Filter -->
              <div class="col-md-2 col-sm-6 col-xs-12">
                <div class="filter-section">
                  <label class="filter-title">Material</label>
                  <select name="material" class="form-control">
                    <option value="">All Materials</option>
                    {% for material in materials %}
                      <option value="{{ material.id }}" {% if material.id|stringformat:"s" == selected_material %}selected{% endif %}>
                        {{ material.name }}
                      </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              
              <!-- Price Range -->
              <div class="col-md-3 col-sm-12 col-xs-12">
                <div class="filter-section">
                  <label class="filter-title">Price Range</label>
                  <div class="row">
                    <div class="col-xs-6">
                      <input type="number" class="form-control" name="min_price" value="{{ min_price }}" placeholder="Min">
                    </div>
                    <div class="col-xs-6">
                      <input type="number" class="form-control" name="max_price" value="{{ max_price }}" placeholder="Max">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-8 col-sm-8 col-xs-12">
                <button type="submit" class="btn btn-primary" style="margin-right: 10px; margin-bottom: 10px;">
                  <i class="fas fa-search"></i> Apply Filters
                </button>
                <a href="{% url 'search_products' %}" class="btn btn-default" style="margin-bottom: 10px;">
                  <i class="fas fa-times"></i> Clear Filters
                </a>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Results Info and Sorting -->
    <div class="row">
      <div class="col-md-12">
        <div class="results-info">
          <div class="row">
            <div class="col-md-6 col-sm-6 col-xs-12">
              <h4 style="margin: 0; margin-bottom: 10px;">
                <i class="fas fa-glasses"></i>
                {{ total_results }} Product{{ total_results|pluralize }} Found
              </h4>
            </div>
            <div class="col-md-6 col-sm-6 col-xs-12 sort-section">
              <form method="GET" class="form-inline" style="display: inline;">
                <!-- Preserve all current parameters -->
                <input type="hidden" name="q" value="{{ query }}">
                <input type="hidden" name="category" value="{{ selected_category }}">
                <input type="hidden" name="gender" value="{{ selected_gender }}">
                <input type="hidden" name="material" value="{{ selected_material }}">
                <input type="hidden" name="min_price" value="{{ min_price }}">
                <input type="hidden" name="max_price" value="{{ max_price }}">
                
                <div class="form-group">
                  <label style="margin-right: 10px;">Sort by:</label>
                  <select name="sort" class="form-control" onchange="this.form.submit()">
                    <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Name (A-Z)</option>
                    <option value="price_low" {% if sort_by == 'price_low' %}selected{% endif %}>Price (Low to High)</option>
                    <option value="price_high" {% if sort_by == 'price_high' %}selected{% endif %}>Price (High to Low)</option>
                    <option value="newest" {% if sort_by == 'newest' %}selected{% endif %}>Newest First</option>
                  </select>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Products Grid -->
    {% if products %}
      <div class="container py-5">
        <div class="row g-4">
          {% for product in products %}
            <div class="col-6 col-md-4 col-lg-3">
              <div class="product-card">
                <div class="product-img-container">
                  <!-- Product Badges -->
                  <div class="new-badge">NEW</div>
                  {% if product.discount %}
                    <div class="discount-badge">{{ product.discount }}% Off</div>
                  {% endif %}
                  
                  <a href="{% url 'product_details' product.pk %}">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" width="100%" class="img-fluid w-100 rounded">
                  </a>
                </div>
                <div class="product-info">
                  <h5 class="product-name">{{ product.name }}</h5>
                  <div class="product-category">
                    {% if product.category %}{{ product.category.name }}{% endif %}
                    {% if product.gender %} - {{ product.gender.name }}{% endif %}
                  </div>
                  {% if product.color %}
                    <div class="product-colors">Color: {{ product.color }}</div>
                  {% endif %}
                  {% if product.material %}
                    <div class="product-colors">Material: {{ product.material.name }}</div>
                  {% endif %}
                  <div class="product-rating">★★★★☆</div>
                  <div class="lens-discount">60% Off Lenses</div>
                  <div class="mt-3">
                    <div>Frame:</div>
                    <div class="product-price">₹{{ product.price }}</div>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% else %}
      <div class="no-results">
        <i class="fas fa-search"></i>
        <h3>No products found</h3>
        <p>Try adjusting your search criteria or browse our categories.</p>
        <a href="{% url 'search_products' %}" class="btn btn-primary">View All Products</a>
      </div>
    {% endif %}

    <!-- Pagination -->
    {% if products.has_other_pages %}
      <div class="pagination-wrapper">
        <nav aria-label="Page navigation">
          <ul class="pagination">
            {% if products.has_previous %}
              <li>
                <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ products.previous_page_number }}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                </a>
              </li>
            {% endif %}

            {% for num in products.paginator.page_range %}
              {% if products.number == num %}
                <li class="active"><span>{{ num }}</span></li>
              {% elif num > products.number|add:'-3' and num < products.number|add:'3' %}
                <li>
                  <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ num }}">{{ num }}</a>
                </li>
              {% endif %}
            {% endfor %}

            {% if products.has_next %}
              <li>
                <a href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ products.next_page_number }}" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                </a>
              </li>
            {% endif %}
          </ul>
        </nav>
      </div>
    {% endif %}
  </div>

  <div class="container-fluid">
    <hr style="
      border: 0;
      height: 2px;
      background-image: linear-gradient(to right, rgba(0, 0, 0, 0.678), rgba(0, 0, 0, 0.15), rgba(0, 0, 0, 0.678));
      margin: 30px 0;
    ">
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row">

        <div class="col-md-3 mb-4">
          <h3>ＯＰＴＩＣＦＲＡＭＥ</h3>
        </div>

        <div class="col-md-3 mb-4">
          <h3>About Us</h3>
          <ul class="list-unstyled">
            <li><a href="#">We Are Hiring</a></li>
            <li><a href="#">Refer And Earn</a></li>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Lenskart Coupons</a></li>
          </ul>
        </div>

        <div class="col-md-3 mb-4">
          <h3>Help</h3>
          <ul class="list-unstyled">
            <li><a href="#">FAQ's</a></li>
            <li><a href="#">Grievance Redressal</a></li>
            <li><a href="#">Cardemi</a></li>
          </ul>
        </div>

        <div class="col-md-3 mb-4 text-md-end text-center">
          <h3>Follow Us</h3>
          <div class="social-icons">
            <a href="https://www.facebook.com" target="_blank"><i class="bi bi-facebook"></i></a>
            <a href="https://twitter.com" target="_blank"><i class="bi bi-twitter"></i></a>
            <a href="https://www.linkedin.com" target="_blank"><i class="bi bi-linkedin"></i></a>
            <a href="https://www.instagram.com" target="_blank"><i class="bi bi-instagram"></i></a>
          </div>
        </div>

      </div>

      <hr>

      <div class="d-flex flex-column flex-md-row justify-content-between align-items-center pt-3">
        <div class="mb-2 mb-md-0">
          <a href="#" class="me-3">T & C</a>
          <a href="#" class="me-3">Privacy</a>
          <a href="#" class="me-3">Disclaimer</a>
        </div>
        <div class="mb-2 mb-md-0">
          Version 1.0.0 || Follow Us
          <span class="social-icons">
            <a href="#"><i class="bi bi-facebook"></i></a>
            <a href="#"><i class="bi bi-instagram"></i></a>
            <a href="#"><i class="bi bi-twitter"></i></a>
          </span>
        </div>
      </div>

    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>

</body>
</html>